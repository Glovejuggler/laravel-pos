import{o as i,f as r,b as e,t as n,F,h as N,k as E,r as m,T as Z,D as J,m as K,a as u,w as y,u as v,g,Z as X,d as Y,bW as j,B as _}from"./app-bx6r09WD.js";import{_ as D}from"./Modal-B8EYgpVm.js";import{Z as ee}from"./index-CbjWbaYu.js";import{_ as L}from"./InputLabel-B5yz-yQR.js";import{_ as O}from"./TextInput-LJVBlx_m.js";import{_ as M}from"./ExpensesCard-D-9EYZ_m.js";const te={class:"w-64 bg-white pb-6 z-10"},se={class:"grid grid-cols-2"},le={class:"text-right"},ne={class:"grid grid-cols-2"},oe={class:"text-right"},ae={class:"flex justify-between pl-4 w-full"},ie={class:"w-full"},re={class:"font-bold text-lg flex justify-between"},de={class:"pl-4"},ue={class:"flex justify-between text-sm"},me={class:"flex justify-between text-sm"},fe={class:"text-right"},ce={class:"flex justify-between text-sm"},ve={class:"w-max"},be={__name:"Receipt",props:{receipt:{type:Object,required:!0}},setup(l){return(f,o)=>(i(),r("div",te,[o[11]||(o[11]=e("div",{class:"flex justify-center"},[e("img",{src:"logo.jpg",class:"w-32",alt:""})],-1)),e("div",se,[e("p",null,n(l.receipt.name??" "),1),e("p",le,n(`Order #${l.receipt.number}`),1)]),e("div",ne,[o[0]||(o[0]=e("b",null,"Type",-1)),e("b",oe,n(l.receipt.type),1)]),o[12]||(o[12]=e("hr",{class:"border-black mt-2"},null,-1)),o[13]||(o[13]=e("div",{class:"flex justify-between"},[e("p",null,"Item"),e("p",null,"Subtotal")],-1)),o[14]||(o[14]=e("hr",{class:"border-black mb-2"},null,-1)),e("div",null,[(i(!0),r(F,null,N(l.receipt.items,c=>(i(),r("div",null,[e("p",null,n(c.name),1),e("div",ae,[e("p",ie,n(Number(c.price).amountFormat())+" x"+n(c.quantity),1),e("p",null,n((c.quantity*c.price).amountFormat()),1)])]))),256)),o[5]||(o[5]=e("hr",{class:"border-black my-2"},null,-1)),e("div",null,[e("div",re,[o[1]||(o[1]=e("p",null,"TOTAL",-1)),e("p",null,n(l.receipt.gross.amountFormat()),1)]),e("div",de,[e("p",null,"CASH: "+n(Number(l.receipt.payment).amountFormat()),1),e("p",null,"CHANGE: "+n((l.receipt.payment-l.receipt.gross).amountFormat()),1)])]),o[6]||(o[6]=e("hr",{class:"border-black my-2"},null,-1)),o[7]||(o[7]=e("div",{class:"flex justify-center"},[e("p",null,"Thank you. Come again.")],-1)),e("div",ue,[o[2]||(o[2]=e("p",null,"Cashier",-1)),e("p",null,n(f.$page.props.auth.user.name),1)]),e("div",me,[o[3]||(o[3]=e("p",null,"Order ID",-1)),e("p",fe,n(`dQw4w9WgXcQ${l.receipt.id.pad(4)}`),1)]),e("div",ce,[o[4]||(o[4]=e("p",{class:"w-max"},"Order Time",-1)),e("p",ve,n(Intl.DateTimeFormat("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"numeric",hour12:!0}).format(new Date(l.receipt.created_at))),1)]),o[8]||(o[8]=e("div",{class:"flex flex-col items-center justify-center text-sm mt-2 w-full"},[e("b",null,"UPTop Diner"),e("p",null,"25 L. Geirosa Ave., Brgy. Silangan"),e("p",null,"Calauan, Laguna"),e("p",null,"La Famiglia Building 2nd Floor")],-1)),o[9]||(o[9]=e("hr",{class:"border-black my-2"},null,-1)),o[10]||(o[10]=e("p",null,"THIS IS NOT AN OFFICIAL RECEIPT",-1))])]))}},xe={class:"max-w-7xl mx-auto px-6 py-8 lg:px-8 z-50"},pe={class:"flex justify-between items-center mb-4"},ge={key:0,class:"flex space-x-2 items-center"},we={key:1,class:"dark:text-white"},ye={key:0,class:"w-full rounded-lg dark:bg-zinc-800 bg-white dark:text-white p-4 flex flex-col relative"},he={key:0,class:"w-full lg:w-1/4"},ke={class:"flex justify-between"},$e={class:"flex justify-between"},Ce={class:"flex justify-between"},je={class:"flex justify-between"},De={class:"flex justify-between"},Fe={key:1,class:"w-full lg:w-1/4"},Te={class:"flex justify-between"},Ie={class:"flex justify-end"},Se={class:"lg:absolute bottom-0 right-0 lg:p-4 mt-2 space-x-2 self-end"},ze=["disabled"],Oe=["disabled"],Ne={key:1,class:"dark:text-white w-full bg-white dark:bg-zinc-800 text-left text-sm rounded-lg overflow-hidden mt-4"},Ve={class:"p-4"},Ae={class:"bg-white dark:bg-zinc-800 border-b border-zinc-700"},Ee={class:"px-4 py-2"},Le={class:"px-4 py-2"},Me={key:0,class:"text-xs opacity-70"},He={class:"px-4 py-2"},Pe={class:"px-4 py-2"},Be={class:"px-4 py-2"},Re={class:"px-4 py-2"},qe={class:"px-4 py-2"},Ue={class:"px-4 py-2"},Ge={class:"flex space-x-2"},Qe=["onClick"],We=["onClick"],Ze={class:"bg-white font-bold dark:bg-zinc-800"},Je={class:"px-4 py-2"},Ke={class:"px-4 py-2"},Xe={class:"px-4 py-2"},Ye={key:2,class:"flex justify-center mt-14"},_e={class:"dark:text-white p-6"},et={class:"flex justify-center mt-4 font-bold tracking-wider text-4xl"},tt={class:"dark:text-white p-4"},st={class:"mt-4 grid grid-cols-2 gap-2"},lt={class:"dark:text-white p-4"},nt={class:"flex flex-row-reverse gap-4 mt-8"},ot={class:"dark:text-white p-4"},at={class:"flex flex-row-reverse mt-4 gap-4"},it={key:0,class:"fixed top-0 -left-96"},vt={__name:"Sales",props:{transactions:Object,filters:Object,total:Object,batchDates:Object,expenses:Object},setup(l){const f=l,o=E(()=>f.expenses.net.reduce((a,t)=>a+Number(t.amount),0)),c=E(()=>f.expenses.cogs.reduce((a,t)=>a+Number(t.amount),0)),H=(a,t)=>{const s=Math.ceil(a),d=Math.floor(t);return Math.floor(Math.random()*(d-s+1)+s)},h=m(!1),V=m(null),T=m(""),I=m(null),P=a=>{V.value=a,T.value=H(1e5,999999),h.value=!0,_(()=>I.value.focus())},B=a=>{a==T.value&&j.delete(route("order.cancel",V.value.id),{onStart:()=>I.value.disabled=!0,onSuccess:()=>h.value=!1})},b=f.filters.date?new Date(f.filters.date):new Date,R=b<new Date(new Date().setHours(0,0,0,0)),S=a=>{let t=new Date(a);return Intl.DateTimeFormat("en-PH",{month:"long",day:"numeric",year:"numeric"}).format(t)},q=Z({search:f.filters.search,date:f.filters.date}),x=m({from:"",to:""}),k=m(!1);J(q,a=>{j.get(route("sales"),a,{preserveState:!0,preserveScroll:!0,replace:!0})},{deep:!0});const U=d=>{var d=parseInt(d,10),t=Math.floor(d/3600),s=Math.floor((d-t*3600)/60),d=d-t*3600-s*60;return t?s?`${t}h ${s}m ${d}s`:`${t}h ${d}s`:s?`${s}m ${d}s`:`${d}s`},A=m(!1);K(()=>{let a=navigator.userAgent.toLowerCase();A.value=a.indexOf("android")>-1});const w=m(!1),$=m(null),G=a=>{$.value=a,w.value=!0},Q=()=>{const a=document.getElementById("receipt");ee(a,{quality:1,scale:2}).then(t=>{console.log(t),A.value&&(window.location.href="rawbt:"+t)}).finally(()=>{w.value=!1,$.value=null})},p=m(1),C=m(!1),z=m(null),W=()=>{let a=new Date(z.value).toLocaleDateString("en-PH");console.log(a),j.get(route("sales"),{date:a})};return(a,t)=>(i(),r(F,null,[u(v(X),null,{default:y(()=>[...t[18]||(t[18]=[e("title",null,`
            Sales
        `,-1)])]),_:1}),e("div",xe,[e("div",pe,[l.filters.advanced===void 0?(i(),r("div",ge,[e("i",{onClick:t[0]||(t[0]=s=>a.$inertia.get(a.route("sales"),{date:new Date(v(b).setDate(v(b).getDate()-1)).toLocaleDateString("en-PH")})),class:"bx bxs-chevron-left dark:text-white hover:bg-white hover:text-zinc-900 w-6 h-6 inline-flex justify-center items-center rounded-full border dark:border-white"}),e("p",{onClick:t[1]||(t[1]=s=>C.value=!0),class:"dark:text-white font-semibold cursor-pointer"},n(v(b).toWordFormat()),1),R?(i(),r("i",{key:0,onClick:t[2]||(t[2]=s=>a.$inertia.get(a.route("sales"),{date:new Date(v(b).setDate(v(b).getDate()+1)).toLocaleDateString("en-PH")})),class:"bx bxs-chevron-right dark:text-white hover:bg-white hover:text-zinc-900 w-6 h-6 inline-flex justify-center items-center rounded-full border dark:border-white"})):g("",!0)])):(i(),r("span",we,n(`${S(l.batchDates.from)} to ${S(l.batchDates.to)}`),1)),e("button",{onClick:t[3]||(t[3]=s=>k.value=!0),class:"text-sm dark:text-white hover:underline hover:text-blue-500 duration-200 ease-in-out"},"Advanced filter")]),l.transactions.length?(i(),r("div",ye,[p.value===1?(i(),r("div",he,[e("div",ke,[t[19]||(t[19]=e("span",null,"Total orders:",-1)),e("b",null,n(l.transactions.length),1)]),e("div",$e,[t[20]||(t[20]=e("span",null,"Gross sales:",-1)),e("b",null,n(l.total.gross.amountFormat()),1)]),e("div",Ce,[t[21]||(t[21]=e("span",null,"Cost of goods sold:",-1)),e("b",null,n(l.total.cost.amountFormat()),1)]),e("div",je,[t[22]||(t[22]=e("span",null,"Income:",-1)),e("b",null,n((l.total.gross-l.total.cost).amountFormat()),1)]),u(M,{title:"Expenses",data:l.expenses.net,total:o.value},null,8,["data","total"]),e("div",De,[t[23]||(t[23]=e("span",null,"Net Income:",-1)),e("b",null,n((l.total.gross-l.total.cost-o.value).amountFormat()),1)])])):g("",!0),p.value===2?(i(),r("div",Fe,[t[25]||(t[25]=e("b",null,"Inventory Expense",-1)),e("div",Te,[t[24]||(t[24]=e("span",null,"Cost of goods sold:",-1)),e("b",null,n(l.total.cost.amountFormat()),1)]),u(M,{title:"Expenses",data:l.expenses.cogs,total:c.value},null,8,["data","total"]),e("div",Ie,[e("b",null,n((l.total.cost-c.value).amountFormat()),1)])])):g("",!0),e("div",Se,[e("button",{onClick:t[4]||(t[4]=s=>p.value-=1),disabled:p.value===1,class:"bx bxs-chevron-left dark:text-white enabled:hover:bg-white enabled:hover:text-zinc-900 w-6 h-6 inline-flex justify-center items-center rounded-full border dark:border-white disabled:opacity-20"},null,8,ze),e("button",{onClick:t[5]||(t[5]=s=>p.value+=1),disabled:p.value===2,class:"bx bxs-chevron-right dark:text-white enabled:hover:bg-white enabled:hover:text-zinc-900 w-6 h-6 inline-flex justify-center items-center rounded-full border dark:border-white disabled:opacity-20"},null,8,Oe)])])):g("",!0),l.transactions.length?(i(),r("table",Ne,[e("thead",null,[e("tr",null,[t[26]||(t[26]=e("th",{class:"p-4"},"Customer",-1)),e("th",Ve,n(l.batchDates?"Date":"Time"),1),t[27]||(t[27]=e("th",{class:"p-4"},"Order Type",-1)),t[28]||(t[28]=e("th",{class:"p-4"},"Orders",-1)),t[29]||(t[29]=e("th",{class:"p-4"},"Quantity",-1)),t[30]||(t[30]=e("th",{class:"p-4"},"Gross Sales",-1)),t[31]||(t[31]=e("th",{class:"p-4"},"Net Income",-1)),t[32]||(t[32]=e("th",{class:"p-4"},"Actions",-1))])]),e("tbody",null,[(i(!0),r(F,null,N(l.transactions,s=>(i(),r("tr",Ae,[e("td",Ee,n(s.name??`#${s.number}`),1),e("td",Le,[Y(n(l.batchDates?S(s.created_at):new Date(s.created_at).toTimeFormat())+" ",1),l.batchDates?g("",!0):(i(),r("span",Me,n(U(s.elapsed)),1))]),e("td",He,n(s.type),1),e("td",Pe,[e("div",null,[(i(!0),r(F,null,N(s.items,d=>(i(),r("p",null,n(`${d.name} x${d.quantity}`),1))),256))])]),e("td",Be,n(s.quantity),1),e("td",Re,n(s.gross.amountFormat()),1),e("td",qe,n((s.gross-s.cost).amountFormat()),1),e("td",Ue,[e("div",Ge,[e("i",{onClick:d=>G(s),class:"bx bx-printer dark:text-white inline-flex justify-center items-center p-2 rounded-full bg-green-500 hover:bg-green-700 active:bg-green-900 duration-200 ease-in-out cursor-pointer"},null,8,Qe),e("i",{onClick:d=>P(s),class:"bx bx-trash dark:text-white inline-flex justify-center items-center p-2 rounded-full bg-red-500 hover:bg-red-700 active:bg-red-900 duration-200 ease-in-out cursor-pointer"},null,8,We)])])]))),256)),e("tr",Ze,[e("td",Je,n(l.transactions.length),1),t[33]||(t[33]=e("td",{class:"px-4 py-2"},null,-1)),t[34]||(t[34]=e("td",{class:"px-4 py-2"},null,-1)),t[35]||(t[35]=e("td",{class:"px-4 py-2"},null,-1)),t[36]||(t[36]=e("td",{class:"px-4 py-2"},null,-1)),e("td",Ke,n(l.total.gross.amountFormat()),1),e("td",Xe,n((l.total.gross-l.total.cost).amountFormat()),1),t[37]||(t[37]=e("td",{class:"px-4 py-2"},null,-1))])])])):(i(),r("div",Ye,[...t[38]||(t[38]=[e("div",{class:"flex justify-center items-center flex-col text-zinc-700 dark:text-zinc-400"},[e("i",{class:"bx bx-ghost text-7xl"}),e("p",null,"Oohh... It's empty in here.")],-1)])]))]),u(D,{show:h.value,"max-width":"md",onClose:t[7]||(t[7]=s=>h.value=!1)},{default:y(()=>[e("div",_e,[t[39]||(t[39]=e("p",{class:"font-bold"},"Confirmation",-1)),t[40]||(t[40]=e("p",{class:"mt-4"},"This transaction record will be deleted. Enter the code to continue.",-1)),e("div",et,n(T.value),1),e("input",{ref_key:"codeInput",ref:I,onKeyup:t[6]||(t[6]=s=>B(s.target.value)),class:"bg-zinc-900 w-full rounded-lg mt-2 disabled:opacity-50",type:"text"},null,544)])]),_:1},8,["show"]),u(D,{show:w.value,onClose:t[9]||(t[9]=s=>w.value=!1)},{default:y(()=>[e("div",tt,[t[41]||(t[41]=e("p",{class:"font-bold"},"Confirmation",-1)),t[42]||(t[42]=e("p",{class:"mt-4"},"Print this receipt?",-1)),e("div",st,[e("button",{onClick:Q,class:"bg-green-500 rounded-lg py-2 hover:bg-green-600 active:bg-green-800 duration-200 ease-in-out"},"Yes"),e("button",{onClick:t[8]||(t[8]=s=>w.value=!1),class:"bg-zinc-500 rounded-lg py-2 hover:bg-zinc-600 active:bg-zinc-900 duration-200 ease-in-out"},"Cancel")])])]),_:1},8,["show"]),u(D,{show:k.value,onClose:t[14]||(t[14]=s=>k.value=!1),"max-width":"md",closeable:!1},{default:y(()=>[e("div",lt,[u(L,{for:"from",value:"From"}),u(O,{type:"date",id:"from",modelValue:x.value.from,"onUpdate:modelValue":t[10]||(t[10]=s=>x.value.from=s),class:"w-full mt-2"},null,8,["modelValue"]),u(L,{class:"mt-4",for:"to",value:"To"}),u(O,{type:"date",id:"to",modelValue:x.value.to,"onUpdate:modelValue":t[11]||(t[11]=s=>x.value.to=s),class:"w-full mt-2"},null,8,["modelValue"]),e("div",nt,[e("button",{onClick:t[12]||(t[12]=s=>v(j).get(a.route("sales"),{advanced:{from:x.value.from,to:x.value.to}})),class:"text-white rounded-lg bg-green-500 hover:bg-green-600 active:bg-green-800 duration-200 ease-in-out px-6 py-2 text-sm"},"Submit"),e("button",{onClick:t[13]||(t[13]=s=>k.value=!1),class:"dark:text-white hover:underline text-sm"},"Cancel")])])]),_:1},8,["show"]),u(D,{show:C.value,onClose:t[17]||(t[17]=s=>C.value=!1),"max-width":"md",closeable:!1},{default:y(()=>[e("div",ot,[u(O,{type:"date",id:"jump",modelValue:z.value,"onUpdate:modelValue":t[15]||(t[15]=s=>z.value=s),class:"w-full"},null,8,["modelValue"]),e("div",at,[e("button",{onClick:W,class:"text-white rounded-lg bg-green-500 hover:bg-green-600 active:bg-green-800 duration-200 ease-in-out px-6 py-2 text-sm"},"Jump"),e("button",{onClick:t[16]||(t[16]=s=>C.value=!1),class:"dark:text-white hover:underline text-sm"},"Cancel")])])]),_:1},8,["show"]),$.value?(i(),r("div",it,[u(be,{receipt:$.value,id:"receipt"},null,8,["receipt"])])):g("",!0)],64))}};export{vt as default};
