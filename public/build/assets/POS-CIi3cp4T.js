import{z as fe,k as M,h as de,B as he,o as S,f as I,a as oe,w as ae,u as me,b as d,F as W,l as ne,e as q,d as ve,t as D,g as re,i as pe,C as ge,n as ie,s as be,Z as xe}from"./app-KLRp81hP.js";import{_ as we}from"./Modal-DqTQOnhp.js";var se={exports:{}};(function(H){(function(J){var f=N(),R=le(),F=ue(),b=ce(),y={imagePlaceholder:void 0,cacheBust:!1},p={toSvg:V,toPng:Z,toJpeg:K,toBlob:Q,toPixelData:X,impl:{fontFaces:F,images:b,util:f,inliner:R,options:{}}};H.exports=p;function V(n,t){return t=t||{},Y(t),Promise.resolve(n).then(function(i){return G(i,t.filter,!0)}).then(g).then(a).then(r).then(function(i){return s(i,t.width||f.width(n),t.height||f.height(n))});function r(i){return t.bgcolor&&(i.style.backgroundColor=t.bgcolor),t.width&&(i.style.width=t.width+"px"),t.height&&(i.style.height=t.height+"px"),t.style&&Object.keys(t.style).forEach(function(h){i.style[h]=t.style[h]}),i}}function X(n,t){return O(n,t||{}).then(function(r){return r.getContext("2d").getImageData(0,0,f.width(n),f.height(n)).data})}function Z(n,t){return O(n,t||{}).then(function(r){return r.toDataURL()})}function K(n,t){return t=t||{},O(n,t).then(function(r){return r.toDataURL("image/jpeg",t.quality||1)})}function Q(n,t){return O(n,t||{}).then(f.canvasToBlob)}function Y(n){typeof n.imagePlaceholder>"u"?p.impl.options.imagePlaceholder=y.imagePlaceholder:p.impl.options.imagePlaceholder=n.imagePlaceholder,typeof n.cacheBust>"u"?p.impl.options.cacheBust=y.cacheBust:p.impl.options.cacheBust=n.cacheBust}function O(n,t){return V(n,t).then(f.makeImage).then(f.delay(100)).then(function(i){var h=r(n);return h.getContext("2d").drawImage(i,0,0),h});function r(i){var h=document.createElement("canvas");if(h.width=t.width||f.width(i),h.height=t.height||f.height(i),t.bgcolor){var c=h.getContext("2d");c.fillStyle=t.bgcolor,c.fillRect(0,0,h.width,h.height)}return h}}function G(n,t,r){if(!r&&t&&!t(n))return Promise.resolve();return Promise.resolve(n).then(i).then(function(o){return h(n,o,t)}).then(function(o){return c(n,o)});function i(o){return o instanceof HTMLCanvasElement?f.makeImage(o.toDataURL()):o.cloneNode(!1)}function h(o,l,C){var T=o.childNodes;if(T.length===0)return Promise.resolve(l);return x(l,f.asArray(T),C).then(function(){return l});function x(L,E,w){var k=Promise.resolve();return E.forEach(function(j){k=k.then(function(){return G(j,w)}).then(function(_){_&&L.appendChild(_)})}),k}}function c(o,l){if(!(l instanceof Element))return l;return Promise.resolve().then(C).then(T).then(x).then(L).then(function(){return l});function C(){E(window.getComputedStyle(o),l.style);function E(w,k){w.cssText?k.cssText=w.cssText:j(w,k);function j(_,B){f.asArray(_).forEach(function(e){B.setProperty(e,_.getPropertyValue(e),_.getPropertyPriority(e))})}}}function T(){[":before",":after"].forEach(function(w){E(w)});function E(w){var k=window.getComputedStyle(o,w),j=k.getPropertyValue("content");if(j===""||j==="none")return;var _=f.uid();l.className=l.className+" "+_;var B=document.createElement("style");B.appendChild(e(_,w,k)),l.appendChild(B);function e(u,v,m){var P="."+u+":"+v,A=m.cssText?ee(m):te(m);return document.createTextNode(P+"{"+A+"}");function ee(U){var $=U.getPropertyValue("content");return U.cssText+" content: "+$+";"}function te(U){return f.asArray(U).map($).join("; ")+";";function $(z){return z+": "+U.getPropertyValue(z)+(U.getPropertyPriority(z)?" !important":"")}}}}}function x(){o instanceof HTMLTextAreaElement&&(l.innerHTML=o.value),o instanceof HTMLInputElement&&l.setAttribute("value",o.value)}function L(){l instanceof SVGElement&&(l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l instanceof SVGRectElement&&["width","height"].forEach(function(E){var w=l.getAttribute(E);w&&l.style.setProperty(E,w)}))}}}function g(n){return F.resolveAll().then(function(t){var r=document.createElement("style");return n.appendChild(r),r.appendChild(document.createTextNode(t)),n})}function a(n){return b.inlineAll(n).then(function(){return n})}function s(n,t,r){return Promise.resolve(n).then(function(i){return i.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(i)}).then(f.escapeXhtml).then(function(i){return'<foreignObject x="0" y="0" width="100%" height="100%">'+i+"</foreignObject>"}).then(function(i){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+r+'">'+i+"</svg>"}).then(function(i){return"data:image/svg+xml;charset=utf-8,"+i})}function N(){return{escape:L,parseExtension:t,mimeType:r,dataAsUrl:x,isDataUrl:i,canvasToBlob:c,resolveUrl:o,getAndEncode:T,uid:l(),delay:E,asArray:w,escapeXhtml:k,makeImage:C,width:j,height:_};function n(){var e="application/font-woff",u="image/jpeg";return{woff:e,woff2:e,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:u,jpeg:u,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function t(e){var u=/\.([^\.\/]*?)$/g.exec(e);return u?u[1]:""}function r(e){var u=t(e).toLowerCase();return n()[u]||""}function i(e){return e.search(/^(data:)/)!==-1}function h(e){return new Promise(function(u){for(var v=window.atob(e.toDataURL().split(",")[1]),m=v.length,P=new Uint8Array(m),A=0;A<m;A++)P[A]=v.charCodeAt(A);u(new Blob([P],{type:"image/png"}))})}function c(e){return e.toBlob?new Promise(function(u){e.toBlob(u)}):h(e)}function o(e,u){var v=document.implementation.createHTMLDocument(),m=v.createElement("base");v.head.appendChild(m);var P=v.createElement("a");return v.body.appendChild(P),m.href=u,P.href=e,P.href}function l(){var e=0;return function(){return"u"+u()+e++;function u(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function C(e){return new Promise(function(u,v){var m=new Image;m.onload=function(){u(m)},m.onerror=v,m.src=e})}function T(e){var u=3e4;return p.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime()),new Promise(function(v){var m=new XMLHttpRequest;m.onreadystatechange=ee,m.ontimeout=te,m.responseType="blob",m.timeout=u,m.open("GET",e,!0),m.send();var P;if(p.impl.options.imagePlaceholder){var A=p.impl.options.imagePlaceholder.split(/,/);A&&A[1]&&(P=A[1])}function ee(){if(m.readyState===4){if(m.status!==200){P?v(P):U("cannot fetch resource: "+e+", status: "+m.status);return}var $=new FileReader;$.onloadend=function(){var z=$.result.split(/,/)[1];v(z)},$.readAsDataURL(m.response)}}function te(){P?v(P):U("timeout of "+u+"ms occured while fetching resource: "+e)}function U($){console.error($),v("")}})}function x(e,u){return"data:"+u+";base64,"+e}function L(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function E(e){return function(u){return new Promise(function(v){setTimeout(function(){v(u)},e)})}}function w(e){for(var u=[],v=e.length,m=0;m<v;m++)u.push(e[m]);return u}function k(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")}function j(e){var u=B(e,"border-left-width"),v=B(e,"border-right-width");return e.scrollWidth+u+v}function _(e){var u=B(e,"border-top-width"),v=B(e,"border-bottom-width");return e.scrollHeight+u+v}function B(e,u){var v=window.getComputedStyle(e).getPropertyValue(u);return parseFloat(v.replace("px",""))}}function le(){var n=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:h,shouldProcess:t,impl:{readUrls:r,inline:i}};function t(c){return c.search(n)!==-1}function r(c){for(var o=[],l;(l=n.exec(c))!==null;)o.push(l[1]);return o.filter(function(C){return!f.isDataUrl(C)})}function i(c,o,l,C){return Promise.resolve(o).then(function(x){return l?f.resolveUrl(x,l):x}).then(C||f.getAndEncode).then(function(x){return f.dataAsUrl(x,f.mimeType(o))}).then(function(x){return c.replace(T(o),"$1"+x+"$3")});function T(x){return new RegExp(`(url\\(['"]?)(`+f.escape(x)+`)(['"]?\\))`,"g")}}function h(c,o,l){if(C())return Promise.resolve(c);return Promise.resolve(c).then(r).then(function(T){var x=Promise.resolve(c);return T.forEach(function(L){x=x.then(function(E){return i(E,L,o,l)})}),x});function C(){return!t(c)}}}function ue(){return{resolveAll:n,impl:{readAll:t}};function n(){return t().then(function(r){return Promise.all(r.map(function(i){return i.resolve()}))}).then(function(r){return r.join(`
`)})}function t(){return Promise.resolve(f.asArray(document.styleSheets)).then(i).then(r).then(function(c){return c.map(h)});function r(c){return c.filter(function(o){return o.type===CSSRule.FONT_FACE_RULE}).filter(function(o){return R.shouldProcess(o.style.getPropertyValue("src"))})}function i(c){var o=[];return c.forEach(function(l){try{f.asArray(l.cssRules||[]).forEach(o.push.bind(o))}catch(C){console.log("Error while reading CSS rules from "+l.href,C.toString())}}),o}function h(c){return{resolve:function(){var l=(c.parentStyleSheet||{}).href;return R.inlineAll(c.cssText,l)},src:function(){return c.style.getPropertyValue("src")}}}}}function ce(){return{inlineAll:t,impl:{newImage:n}};function n(r){return{inline:i};function i(h){return f.isDataUrl(r.src)?Promise.resolve():Promise.resolve(r.src).then(h||f.getAndEncode).then(function(c){return f.dataAsUrl(c,f.mimeType(r.src))}).then(function(c){return new Promise(function(o,l){r.onload=o,r.onerror=l,r.src=c})})}}function t(r){if(!(r instanceof Element))return Promise.resolve(r);return i(r).then(function(){return r instanceof HTMLImageElement?n(r).inline():Promise.all(f.asArray(r.childNodes).map(function(h){return t(h)}))});function i(h){var c=h.style.getPropertyValue("background");return c?R.inlineAll(c).then(function(o){h.style.setProperty("background",o,h.style.getPropertyPriority("background"))}).then(function(){return h}):Promise.resolve(h)}}}})()})(se);var ye=se.exports;const Pe=fe(ye),Ce=d("title",null,`
            POS
        `,-1),Ee={class:"p-4 flex space-x-2"},ke=["onClick"],_e=["src"],Te={class:"absolute bottom-0 inset-x-0 bg-black/50 p-2 text-white"},Ae={class:"absolute top-2 right-2 bg-black/50 text-white rounded-lg p-1"},Se={class:"absolute bottom-0 w-full bg-zinc-800 flex"},Ie=["onClick"],Be={class:"fixed w-3/12 inset-y-0 right-0 bg-zinc-800 p-4 no-print"},Ue={class:"h-1/2 relative overflow-y-auto"},$e={class:"text-white flex justify-between"},je={class:"flex space-x-1"},De=["onClick"],Re={class:"flex space-x-1"},Le=["onClick"],Me=d("i",{class:"bx bx-trash"},null,-1),Ve=[Me],Oe={key:0,class:"font-bold text-white absolute bottom-2"},Fe={class:"text-2xl font-black"},Ne=d("hr",{class:"border-gray-500"},null,-1),ze={key:0,class:"h-1/2 relative"},He=d("span",{class:"mt-4 text-white"},"Payment",-1),Xe={class:"relative block"},Ge={class:"grid grid-cols-2 md:grid-cols-5 gap-2 my-2"},We={key:0,class:"text-white mt-2"},qe=["disabled"],Je={class:"flex justify-center p-4 bg-white text-gray-900 text-3xl font-bold uppercase"},Qe=Object.assign({layout:null},{__name:"POS",props:{items:Object,categories:Object},setup(H){const J=H,f=M(null),R=M(null);M(null);const F=g=>{R.value=g,f.value=J.items[g]},b=M(null),y=de(()=>{var g;return(g=b.value)==null?void 0:g.reduce((a,s)=>a+s.price*s.count,0)}),p=M(0),V=M(!1),X=M(null),Z=()=>{V.value=!0},K=g=>{if(b.value){var a=b.value.findIndex(s=>s.id===g.id);a==-1?(g.count=1,b.value.push(g)):b.value[a].count+=1}else g.count=1,b.value=[g]},Q=g=>{var a=b.value.findIndex(s=>s.id===g.id);b.value[a].count-=1,b.value[a].count===0&&b.value.splice(a,1)},Y=g=>{var a=b.value.findIndex(s=>s.id===g.id);b.value.splice(a,1)},O=()=>{be.post(route("transaction.save"),{items:b.value,payment:p.value}).then(g=>{X.value=g.data.message}).catch(g=>{console.log(g)}).finally(()=>{b.value=null,p.value=null,G(),Z()})};he(()=>{F(J.categories[0].name)});const G=()=>{const g=document.getElementById("receipt");Pe.toPng(g).then(a=>{console.log(a)})};return(g,a)=>(S(),I(W,null,[oe(me(xe),null,{default:ae(()=>[Ce]),_:1}),d("div",{class:"fixed w-9/12 inset-y-0 left-0 select-none no-print",onContextmenu:a[2]||(a[2]=q(()=>{},["prevent"]))},[d("div",Ee,[(S(!0),I(W,null,ne(f.value,s=>(S(),I("div",{class:"border flex w-48 h-48 relative active:scale-95 duration-150 ease-in-out rounded-md overflow-hidden",onClick:N=>K(s),ontouchstart:""},[d("img",{draggable:"false",onContextmenu:a[0]||(a[0]=q(()=>{},["prevent"])),onDragstart:a[1]||(a[1]=q(()=>{},["prevent"])),src:`../storage/${s.pic}`,class:"w-48 h-48 object-cover",height:"25px",width:"25px",alt:""},null,40,_e),d("p",Te,D(s.name),1),d("span",Ae,D(s.price),1)],8,ke))),256))]),d("div",Se,[(S(!0),I(W,null,ne(H.categories,s=>(S(),I("div",{class:ie([{"bg-blue-500 text-white font-bold":R.value===s.name},"py-2 px-4 text-zinc-300 border-r border-zinc-700"]),onClick:N=>F(s.name)},D(s.name),11,Ie))),256))])],32),d("div",Be,[d("div",Ue,[(S(!0),I(W,null,ne(b.value,s=>(S(),I("div",$e,[d("div",je,[d("button",{onClick:N=>Q(s),class:"w-4 h-4 bg-blue-500 inline-flex justify-center items-center"},"-",8,De),d("span",null,D(`${s.name} x${s.count}`),1)]),d("div",Re,[d("span",null,D(s.price*s.count),1),d("button",{onClick:N=>Y(s),class:"w-5 h-5 bg-red-500 inline-flex justify-center items-center"},Ve,8,Le)])]))),256)),y.value>0?(S(),I("p",Oe,[ve("Total: "),d("span",Fe,D(y.value),1)])):re("",!0)]),Ne,y.value?(S(),I("div",ze,[He,d("label",Xe,[pe(d("input",{"onUpdate:modelValue":a[3]||(a[3]=s=>p.value=s),class:"[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none duration-300 ease-in-out placeholder:text-xs placeholder:text-gray-400 text-white block bg-zinc-900 w-full border-slate-300 dark:border-slate-300/20 rounded-md py-2 pl-3 pr-9 shadow-sm focus:border-indigo-300 focus:ring-indigo-200 focus:ring focus:ring-opacity-50",placeholder:"P 0.00",type:"number",name:"payment"},null,512),[[ge,p.value]]),d("i",{onClick:a[4]||(a[4]=q(s=>p.value=null,["self"])),class:"bx bx-x-circle text-white/40 absolute text-xl inset-y-0 right-0 flex items-center pr-3 hover:text-red-500"})]),d("div",Ge,[d("button",{class:"p-2 text-sm font-bold text-gray-800 bg-white rounded-md active:scale-95",onClick:a[5]||(a[5]=s=>p.value+=50)},"50"),d("button",{class:"p-2 text-sm font-bold text-gray-800 bg-white rounded-md active:scale-95",onClick:a[6]||(a[6]=s=>p.value+=100)},"100"),d("button",{class:"p-2 text-sm font-bold text-gray-800 bg-white rounded-md active:scale-95",onClick:a[7]||(a[7]=s=>p.value+=200)},"200"),d("button",{class:"p-2 text-sm font-bold text-gray-800 bg-white rounded-md active:scale-95",onClick:a[8]||(a[8]=s=>p.value+=500)},"500"),d("button",{class:"p-2 text-xs font-bold text-gray-800 bg-white rounded-md active:scale-95",onClick:a[9]||(a[9]=s=>p.value+=1e3)},"1000"),d("button",{class:"bg-white rounded-md w-full p-2 font-bold text-sm active:scale-[0.98] col-span-5",onClick:a[10]||(a[10]=s=>p.value=y.value)},"Exact amount")]),p.value>y.value?(S(),I("p",We,"Change: "+D(y.value&&p.value-y.value),1)):re("",!0),d("button",{class:ie(["bg-white rounded-md text-sm w-full p-2 font-bold enabled:active:scale-[0.98] absolute bottom-0 right-0",{"opacity-50":y.value&&p.value<y.value}]),onClick:O,disabled:y.value&&p.value<y.value},"Place order",10,qe)])):re("",!0)]),oe(we,{"max-width":"sm",show:V.value,onClose:a[11]||(a[11]=s=>V.value=!1),class:"no-print"},{default:ae(()=>[d("div",Je,D(X.value),1)]),_:1},8,["show"])],64))}});export{Qe as default};
